# Called every Jan 1st
# Root does not exist
yearly_global_pulse = {
	on_actions = { TFE_yearly_global_pulse }
}

TFE_yearly_global_pulse = {
	effect = {
		if = {
			limit = { NOT = { exists = global_var:active_conquerors } }
			set_global_variable = {
				name = active_conquerors
				value = 0
			}
		}
		if = {
			limit = {
				any_liege_or_above = {
					government_has_flag = government_is_administrative
				}
			}
			every_vassal_or_below = {
				limit = {
					is_independent_ruler = no
					highest_held_title_tier >= tier_duchy
					government_has_flag = government_is_roman
				}
			}
			change_government = administrative_government
		}
		if = {
			limit = {
				any_liege_or_above = {
					government_has_flag = government_is_autocratic_ep3
				}
			}
			every_vassal_or_below = {
				limit = {
					is_independent_ruler = no
					highest_held_title_tier >= tier_duchy
					government_has_flag = government_is_roman
				}
			}
			change_government = autocratic_governnment_ep3
		}
		if = {
  			limit = { 
       			NOT = { any_held_title = { is_noble_family_title = yes } } 
        		highest_held_title_tier >= tier_duchy
				government_allows = administrative
				is_independent_ruler = no
   			}
     		if = {
        		limit = { is_house_head = no }
      			found_cadet_house_decision_effect = { CHARACTER = root }
    		}
 		    create_noble_family_effect = yes
    		domicile ?= { set_up_domicile_estate_effect = yes }
		}
		if = {
  			limit = { 
       			NOT = { any_held_title = { is_noble_family_title = yes } } 
        		highest_held_title_tier >= tier_kingdom
				government_allows = administrative
				is_independent_ruler = yes
   			}
     		if = {
         		limit = { is_house_head = no }
      		    found_cadet_house_decision_effect = { CHARACTER = root }
    		}
 		    create_noble_family_effect = yes
    		domicile ?= { set_up_domicile_estate_effect = yes }
		}
		# Historical character spawner
		if = {
			limit = {
				NOT = {
					has_game_rule = no_historical_characters
				}
			}
			tfe_spawn_historical_characters_effect = yes
		}
		if = {
			limit = {
				AND = {
					exists = global_var:islam_spawned
					OR = {
						NOT = { exists = title:b_firuzkuh.holder }
						title:b_firuzkuh.title_province = { has_special_building_slot = no }
					}
				}
			}
			title:c_ghur.holder = {
				trigger_event = {
					id = TFE_flavour_events.0037
					days = { 1 10 }
				}
			}
		}
		#Moved to game start since this doesn't have to be islamic
		#if = { 
		#	limit = {
		#		AND = {
		#			exists = global_var:islam_spawned
		#			OR = {
		#				NOT = { exists = title:b_alamut.holder }
		#				title:b_alamut.title_province = { has_special_building_slot = no }
		#			}
		#		}
		#	}
		#	title:c_daylam.holder = {
		#		trigger_event = {
		#			id = TFE_flavour_events.0039
		#			days = { 1 10 }
		#		}
		#	}
		#}
		if = {
			limit = {
				AND = {
					current_date > 800.1.1
					OR = {
						NOT = { exists = title:b_figuira.holder }
						title:b_figuira.title_province = { has_special_building_slot = no }
					}
					title:c_niani.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_niani.holder = {
				trigger_event = {
					id = TFE_flavour_events.0018
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 800.1.1
					OR = {
						NOT = { exists = title:b_siguiri.holder }
						title:b_siguiri.title_province = { has_special_building_slot = no }
					}
					title:c_bure.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_bure.holder = {
				trigger_event = {
					id = TFE_flavour_events.0020
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 800.1.1
					OR = {
						NOT = { exists = title:b_yaresna.holder }
						title:b_yaresna.title_province = { has_special_building_slot = no }
					}
					title:c_bambuk.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_bambuk.holder = {
				trigger_event = {
					id = TFE_flavour_events.0022
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 800.1.1
					OR = {
						NOT = { exists = title:b_polygyros.holder }
						title:b_polygyros.title_province = { has_special_building_slot = no }
					}
					title:c_chalkidike.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_chalkidike.holder = {
				trigger_event = {
					id = TFE_flavour_events.0024
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 800.1.1
					OR = {
						NOT = { exists = title:b_turoc.holder }
						title:b_turoc.title_province = { has_special_building_slot = no }
					}
					title:c_trenscen.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_trenscen.holder = {
				trigger_event = {
					id = TFE_flavour_events.0026
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 900.1.1
					OR = {
						NOT = { exists = title:b_falene.holder }
						title:b_falene.title_province = { has_special_building_slot = no }
					}
					title:c_dalabergslagen.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_dalabergslagen.holder = {
				trigger_event = {
					id = TFE_flavour_events.0028
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 1000.1.1
					OR = {
						NOT = { exists = title:b_caslav.holder }
						title:b_caslav.title_province = { has_special_building_slot = no }
					}
					title:c_caslav.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_caslav.holder = {
				trigger_event = {
					id = TFE_flavour_events.0030
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 1000.1.1
					OR = {
						NOT = { exists = title:b_torda.holder }
						title:b_torda.title_province = { has_special_building_slot = no }
					}
					title:c_torda.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_torda.holder = {
				trigger_event = {
					id = TFE_flavour_events.0052
					days = { 1 18250 }
				}
			}
		}
		if = {
			limit = {
				AND = {
					current_date > 1000.1.1
					OR = {
						NOT = { exists = title:b_falene.holder }
						title:b_falene.title_province = { has_special_building_slot = no }
					}
					title:c_dalabergslagen.holder = {
						NOT = { government_has_flag = government_is_tribal }
					}
				}
			}
			title:c_dalabergslagen.holder = {
				trigger_event = {
					id = TFE_flavour_events.0054
					days = { 1 18250 }
				}
			}
		}
		
		
		# Donatist Revolts
		if = {
			limit = {
				current_date > 339.1.1
				current_date < 430.1.1
				NOT = { has_global_variable = spawned_donatists }
			}
			random = {
				chance = 15
				modifier = {
					add = 15
					current_date >= 371.1.1
				}
				modifier = {
					add = 15
					current_date >= 406.1.1
				}
				modifier = {
					add = 55
					current_date >= 425.1.1
				}
				debug_log = "Attempting to spawn Donatist revolt within 1000 days"
				trigger_event = {
					id = donatist_revolt.0001
					days = { 400 1000 }
				}
				set_global_variable = {
					name = spawned_donatists
					value = yes
				}
			}
		}
		if = {
			limit = {
				current_date >= 399.1.1
				NOT = { exists = global_var:caelestis }
				NOT = {
					title:b_maydara.title_province.county_controller.top_liege.faith.religion = religion:hellenism_religion
				}
			}
			title:b_maydara.title_province = {
				county_controller = {
					top_liege = {
						trigger_event = {
						id = province_events.0006
							days = {30 50}
						}
					}
				}
			}
		}
		
		# if = {
			# limit = {
				# current_date >= 451.1.1
				# NOT = { exists = global_var:germanic_britan }
			# }
			
			# set_global_variable = {
				# name = germanic_britan
				# value = yes
			# }
			# random_list = {
				# 30 = {
					# title:k_saxony.holder = {
						# trigger_event = {
							# id = briton.0007
							# days = {30 50}
						# }
					# }
				# }
				# 10 = {
					# title:k_frisia.holder = {
						# trigger_event = {
							# id = briton.0007
							# days = {30 50}
						# }
					# }
				# }
				# 10 = {
					# title:k_jutland.holder = {
						# trigger_event = {
							# id = briton.0007
							# days = {30 50}
						# }
					# }
				# }
			# }
		# }
		#Spawn Mazdak
		if = {
			limit = {
				current_date >= 488.1.1
				NOT = { exists = global_var:mazdakism_spawned }
			}
			title:c_ctesiphon.holder = {
				trigger_event = {
					id = TFE_zoroastrian.0001
					days = {30 50}
				}
				set_global_variable = {
					name = mazdakism_spawned
					value = yes
				}
			}
		}
		#Spawn Khurramism
		if = {
			limit = {
				game_start_date <= 622.1.1
				OR = {
					NOT = {
						faith:united_islam = {
							has_doctrine = unavailable_doctrine
						}
					}
					NOT = {
						faith:sunni = {
							has_doctrine = unavailable_doctrine
						}
					}
				}
				title:k_mesopotamia = {
					any_in_de_jure_hierarchy = {
						count = 0.3
						AND = {
							tier = tier_county
							religion = religion:islam_religion
						}
					}
				}
				NOT = { exists = global_var:khurramism_spawned }
			}
			title:c_ctesiphon.holder = {
				trigger_event = TFE_zoroastrian.0003
			}
			
		}

		#Spawn Jovinian
		if = {
			limit = {
				current_date >= 393.1.1
				NOT = { exists = global_var:jovinianism_spawned }
			}
			title:c_roma.holder = {
				trigger_event = {
					id = TFE_christian.0001
					days = { 30 50 }
				}
				set_global_variable = {
					name = jovinianism_spawned
					value = yes
				}
			}
		}

		#Spawn Behafiridism aka Zurvanism
		if = {
			limit = {
				game_start_date <= 622.1.1
				current_date >= 700.1.1
				OR = {
					NOT = {
						faith:united_islam = {
							has_doctrine = unavailable_doctrine
						}
					}
					NOT = {
						faith:sunni = {
							has_doctrine = unavailable_doctrine
						}
					}
				}
				title:k_mesopotamia = {
					any_in_de_jure_hierarchy = {
						count = 0.4
						AND = {
							tier = tier_county
							religion = religion:islam_religion
						}
					}
				}
				NOT = { exists = global_var:zurvanism_spawned }
			}
			title:c_ctesiphon.holder = {
				trigger_event = TFE_zoroastrian.0005
			}
			
		}
		#Briton breaky time
		if = {
			limit = {
				current_date >= 550.1.1
				NOT = { exists = global_var:briton_split }
			}
			trigger_event = {
				id = briton.0005
				days = {30 50}
			}
		}
		#Spawning islam
		if = {
			limit = {
				current_date >= 622.1.1
				NOT = {has_global_variable=islam_spawned }
			}
			trigger_event = {
				id = islam.0001
				days = {30 50}
			}
			set_global_variable = {
				name = islam_spawned
				value = yes
			}
		}
		if = {
			limit = {
				current_date > 535.1.1
				NOT = { exists = global_var:ash_year }
			}
			trigger_event = {
				id = ash.0001
				days = {180 190}
			}
			set_global_variable = {
				name = ash_year
				value = yes
			}
		}
		if = {
			limit = {
				game_start_date <= 451.1.1
				current_date >= 451.1.1
				NOT = { exists = global_var:council_chalc }
			}
			trigger_event = {
				id = tfe_ecumenical_council.0001
				days = {0 365}
			}
		}
		# Slavic culture split
		if = {
			limit = {
				AND = {
					current_date <= 450.1.1
					NOT = { has_global_variable = slavs_split }
					current_date >= 400.1.1
					any_independent_ruler = { #performance heavy but should only be calculated for 50 years and not the whole game
						count >= 2
						culture = culture:slavic
					}
				}
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 415.1.1
				}
				modifier = {
					add = 5
					current_date >= 430.1.1
				}
				modifier = {
					add = 10
					current_date >= 440.1.1
				}
				modifier = {
					add = 75
					current_date >= 445.1.1
				}
				set_global_variable = {
					name = slavs_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0091
					days = { 60 300 }
				}
			}
		}
		# These dates are somewhat arbitrary, please change them if you know more about when these cultures actually diverged
		# Aestian culture split
		if = {
			limit = {
				current_date <= 650.1.1
				NOT = { has_global_variable = aestian_culture_split }
				current_date >= 600.1.1
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 615.1.1
				}
				modifier = {
					add = 5
					current_date >= 630.1.1
				}
				modifier = {
					add = 10
					current_date >= 640.1.1
				}
				modifier = {
					add = 75
					current_date >= 649.1.1
				}
				set_global_variable = {
					name = aestian_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0001
					days = { 60 300 }
				}
			}
		}
		# Antean culture split
		if = {
			limit = {
				current_date <= 700.1.1
				NOT = { has_global_variable = fenni_culture_split }
				current_date >= 650.1.1
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 665.1.1
				}
				modifier = {
					add = 5
					current_date >= 680.1.1
				}
				modifier = {
					add = 10
					current_date >= 690.1.1
				}
				modifier = {
					add = 75
					current_date >= 699.1.1
				}
				set_global_variable = {
					name = antean_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0011
					days = { 60 300 }
				}
			}
		}
		# Fenni culture split
		#if = {
		#	limit = {
		#		current_date <= 800.1.1
		#		NOT = { has_global_variable = fenni_culture_split }
		#		current_date >= 750.1.1
		#	}
		#	random = {
		#		chance = 5
		#		modifier = {
		#			add = 5
		#			current_date >= 765.1.1
		#		}
		#		modifier = {
		#			add = 5
		#			current_date >= 780.1.1
		#		}
		#		modifier = {
		#			add = 10
		#			current_date >= 790.1.1
		#		}
		#		modifier = {
		#			add = 75
		#			current_date >= 799.1.1
		#		}
		#		set_global_variable = {
		#			name = fenni_culture_split
		#			value = yes
		#		}
		#		trigger_event = {
		#			id = tfe_culture.0021
		#			days = { 60 300 }
		#		}
		#	}
		#}
		# Venedian culture split
		if = {
			limit = {
				current_date <= 700.1.1
				NOT = { has_global_variable = venedian_culture_split }
				current_date >= 650.1.1
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 665.1.1
				}
				modifier = {
					add = 5
					current_date >= 680.1.1
				}
				modifier = {
					add = 10
					current_date >= 690.1.1
				}
				modifier = {
					add = 75
					current_date >= 699.1.1
				}
				set_global_variable = {
					name = venedian_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0031
					days = { 60 300 }
				}
			}
		}
		# Sclavenian culture split
		if = {
			limit = {
				current_date <= 750.1.1
				NOT = { has_global_variable = sclavenian_culture_split }
				current_date >= 700.1.1
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 715.1.1
				}
				modifier = {
					add = 5
					current_date >= 730.1.1
				}
				modifier = {
					add = 10
					current_date >= 740.1.1
				}
				modifier = {
					add = 75
					current_date >= 749.1.1
				}
				set_global_variable = {
					name = sclavenian_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0041
					days = { 60 300 }
				}
			}
		}
		# Frankish not implemented yet
		# Tiele culture split
		if = {
			limit = {
				current_date <= 600.1.1
				NOT = { has_global_variable = tiele_culture_split }
				current_date >= 400.1.1
			}
			random = {
				chance = 1
				modifier = {
					add = 1
					current_date >= 430.1.1
				}
				modifier = {
					add = 3
					current_date >= 450.1.1
				}
				modifier = {
					add = 5
					current_date >= 470.1.1
				}
				modifier = {
					add = 10
					current_date >= 480.1.1
				}
				modifier = {
					add = 80
					current_date >= 499.1.1
				}
				set_global_variable = {
					name = tiele_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0061
					days = { 60 300 }
				}
			}
		}
		# Gothonic divergence
		if = {
			limit = {
				current_date <= 410.1.1
				NOT = { has_global_variable = gothonic_culture_split }
				current_date >= 396.1.1
			}
			random = {
				chance = 10
				modifier = {
					add = 15
					current_date >= 400.1.1
				}
				modifier = {
					add = 15
					current_date >= 405.1.1
				}
				modifier = {
					add = 60
					current_date >= 409.1.1
				}
				set_global_variable = {
					name = gothonic_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0071
					days = { 60 300 }
				}
			}
		}
		# Hispano-Roman divergence
		if = {
			limit = {
				current_date <= 780.1.1
				NOT = { has_global_variable = hispano_roman_culture_split }
				current_date >= 700.1.1
				NOT = { exists = title:e_western_roman_empire.holder } # Maybe add a way for it to check how long ago the Empire collapsed?
				NOT = { exists = title:e_roman_empire.holder }
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 615.1.1
				}
				modifier = {
					add = 5
					current_date >= 630.1.1
				}
				modifier = {
					add = 10
					current_date >= 645.1.1
				}
				modifier = {
					add = 75
					current_date >= 660.1.1
				}
				set_global_variable = {
					name = hispano_roman_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0501
					days = { 60 300 }
				}
			}
		}

		# Gallo-Roman divergence
		if = {
			limit = {
				current_date <= 780.1.1
				NOT = { has_global_variable = gallo_roman_culture_split }
				current_date >= 700.1.1
				NOT = { exists = title:e_western_roman_empire.holder } # Maybe add a way for it to check how long ago the Empire collapsed?
				NOT = { exists = title:e_roman_empire.holder }
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 615.1.1
				}
				modifier = {
					add = 5
					current_date >= 630.1.1
				}
				modifier = {
					add = 10
					current_date >= 645.1.1
				}
				modifier = {
					add = 75
					current_date >= 660.1.1
				}
				set_global_variable = {
					name = gallo_roman_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0511
					days = { 60 300 }
				}
			}
		}

		# Britano-Roman divergence
		if = {
			limit = {
				current_date <= 780.1.1
				NOT = { has_global_variable = britano_roman_culture_split }
				current_date >= 700.1.1
				NOT = { exists = title:e_western_roman_empire.holder } # Maybe add a way for it to check how long ago the Empire collapsed?
				NOT = { exists = title:e_roman_empire.holder }
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 615.1.1
				}
				modifier = {
					add = 5
					current_date >= 630.1.1
				}
				modifier = {
					add = 10
					current_date >= 645.1.1
				}
				modifier = {
					add = 75
					current_date >= 660.1.1
				}
				set_global_variable = {
					name = britano_roman_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0521
					days = { 60 300 }
				}
			}
		}
		if = {
			limit = {
				current_date <= 600.1.1
				NOT = { has_global_variable = bavarian_culture_split }
				current_date >= 500.1.1
			}
			random = {
				chance = 5
				modifier = {
					add = 5
					current_date >= 540.1.1
				}
				modifier = {
					add = 5
					current_date >= 560.1.1
				}
				modifier = {
					add = 10
					current_date >= 580.1.1
				}
				modifier = {
					add = 75
					current_date >= 590.1.1
				}
				set_global_variable = {
					name = bavarian_culture_split
					value = yes
				}
				trigger_event = {
					id = tfe_culture.0081
					days = { 60 300 }
				}
			}
		}
		if = {
			limit = {
				title:e_hunnic_empire = {
					OR = {
						is_title_created = no
						AND = {
							is_title_created = yes
							holder = {
								realm_size <= 50
							}
						}
					}
				}
				NOT = {
					exists = global_var:hun_dejure_shift
				}
				AND = {
					game_start_date > 394.1.1
					game_start_date < 396.1.1
				}
			}
			dejure_shift_huns_effect = yes
		}
		if = {
			limit = {
				title:k_suebi = {
					OR = {
						is_title_created = no
						AND = {
							is_title_created = yes
							holder = {
								realm_size <= 10
							}
						}
					}
				}
				NOT = {
					exists = global_var:suebi_dejure_shift
				}
				game_start_date = 476.9.4
			}
			dejure_shift_suebi_effect = yes
		}
		if = {
			limit = {
				title:k_vandals = {
					OR = {
						is_title_created = no
						AND = {
							is_title_created = yes
							holder = {
								realm_size <= 10
							}
						}
					}
				}
				NOT = {
					exists = global_var:vandals_dejure_shift
				}
				game_start_date = 476.9.4
			}
			dejure_shift_vandals_effect = yes
		}

		


		if = {
			limit = {
				current_date > 550.1.1
				current_date < 600.1.1
				NOT = { has_global_variable = gokturk_spawned }
				AND = {
					exists = title:e_mongolia.holder
					title:e_mongolia.holder = {
						culture = culture:rouran
						any_realm_county = {
							culture = culture:tujue
						}
					}
				}
			}
			random = {
				chance = 15
				modifier = {
					add = 15
					current_date >= 552.1.1
				}
				modifier = {
					add = 15
					current_date >= 560.1.1
				}
				modifier = {
					add = 55
					current_date >= 570.1.1
				}
				title:e_mongolia.holder = {
					trigger_event = {
						id = TFE_flavour_events.0032
						days = { 100 300 }
					}
				}
				set_global_variable = {
					name = gokturk_spawned
					value = yes
				}
			}
		}

		if = {
			limit = {
				current_date >= 541.1.1
				current_date < 549.1.1
				NOT = { has_global_variable = justinian_plague_spawned }
				title:c_byzantion.holder.top_liege = {
					any_courtier_or_guest = {
						AND = {
							is_foreign_court_or_pool_guest = yes
							is_adult = yes
							is_imprisoned = no
							is_male = yes #not sexism I just don't want to do GetHeShe every time 
						}
					}
				}
			}
			set_global_variable = {
				name = justinian_plague_spawned
				value = yes
			}
			title:c_byzantion.holder.top_liege = {
				trigger_event = {
					id = TFE_flavour_events.0039
					days = { 1 300 }
				}
			}
		}
		if = {
			limit = {
				has_global_variable = justinian_plague_spawned
				NOT = {
					has_global_variable = plague_ended
				}
			}
			set_global_variable = {
				name = justinian_plague_spawned
				value = yes
			}
			title:c_byzantion.holder.top_liege = {
				change_global_variable = {
					name = plague_event_num_counter
					add = 1
				}
				random_list = {
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0040
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0041
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0042
							days = { 1 300 }
						}
					}
					#10 = {
					#	trigger_event = {
					#		id = TFE_flavour_events.0043
					#		days = { 1 300 }
					#	}
					#}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0044
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0045
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0046
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0047
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0048
							days = { 1 300 }
						}
					}
					10 = {
						trigger_event = {
							id = TFE_flavour_events.0049
							days = { 1 300 }
						}
					}
				}
			}
		}
		if = {
			limit = {
				NOT = { has_global_variable = plague_ended }
				has_global_variable = justinian_plague_scope
				NOT = {
					title:c_byzantion.holder.capital_province = {
						any_province_epidemic = {
							THIS = global_var:justinian_plague_scope
						}
					}
				}
			}
			set_global_variable = {
				name = plague_ended
				value = yes
			}
			title:c_byzantion.holder.top_liege = {
				trigger_event = TFE_flavour_events.0050
			}
		}
		if = {
			limit = {
				current_year >= 365
				NOT = { has_global_variable = TFE_395_earthquake_global_flag }
			}				
			set_global_variable = {
				name = TFE_395_earthquake_global_flag
				value = yes
			}
			trigger_event = {
				id = major_disasters.0010
				days = { 0 365 }
			}
		}
	}
}

yearly_playable_pulse = {
	on_actions = { TFE_yearly_playable_pulse }
}

TFE_yearly_playable_pulse = {
	effect = {
		if = {
			limit = {
				exists = var:years_since_last_war
			}
			change_variable = {
				name = years_since_last_war
				add = 1
			}
		}
	}
}

three_year_playable_pulse = {
	on_actions = {
		TFE_three_year_playable_pulse_melting_pot
	}
	on_actions = {
		TFE_three_year_feudalization
	}
	on_actions = {
		TFE_three_year_flavour
	}
}

TFE_three_year_playable_pulse_melting_pot = {
	random_events = {
		250 = 0
		150 = tfe_culture.3000  # Roman -> Italian
		150 = tfe_culture.3010  # Suebic -> Suevi
		200 = tfe_culture.3020  # Anglo-Saxon
	}
}

TFE_three_year_feudalization = {
	random_events = {
		500 = 0
		100 = feudalization.0001  # Start up event for feudal
	}
}

TFE_three_year_flavour = {
	random_events = { # Shatzi: i do not know if these belong here but oh well
		chance_of_no_event = {
			value = 30 # should be 30 for a RICElike effect
		}

		10000 = 0

		100 = TFE_flavour_events.0001 # Monastery of Auxerre
		100 = TFE_flavour_events.0002 # Barbarian PANTS!!

	}
}

